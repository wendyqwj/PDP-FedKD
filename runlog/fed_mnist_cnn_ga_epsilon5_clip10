(venv) wendy@pku:~/code/DPFL$ python3 -u main.py --dataset mnist --dp_mechanism Gaussian --dp_epsilon 5 --dp_clip 10 --gpu 1
/home/wendy/anaconda3/envs/venv/lib/python3.7/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/wendy/anaconda3/envs/venv/lib/python3.7/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
/home/wendy/anaconda3/envs/venv/lib/python3.7/site-packages/torchvision/datasets/mnist.py:65: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
GradSampleModule(CNNMnist(
  (conv1): Conv2d(1, 10, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(10, 20, kernel_size=(5, 5), stride=(1, 1))
  (conv2_drop): Dropout2d(p=0.5, inplace=False)
  (fc1): Linear(in_features=320, out_features=50, bias=True)
  (fc2): Linear(in_features=50, out_features=10, bias=True)
))
/home/wendy/anaconda3/envs/venv/lib/python3.7/site-packages/torch/nn/modules/module.py:1117: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Round   0,Testing accuracy: 11.88,Time:  7.62s
Round   1,Testing accuracy: 10.26,Time:  5.98s
Round   2,Testing accuracy: 11.99,Time:  5.99s
Round   3,Testing accuracy: 12.87,Time:  6.06s
Round   4,Testing accuracy: 14.82,Time:  5.98s
Round   5,Testing accuracy: 18.28,Time:  5.99s
Round   6,Testing accuracy: 17.79,Time:  5.99s
Round   7,Testing accuracy: 23.59,Time:  6.01s
Round   8,Testing accuracy: 22.17,Time:  6.08s
Round   9,Testing accuracy: 20.68,Time:  5.99s
Round  10,Testing accuracy: 30.03,Time:  6.00s
Round  11,Testing accuracy: 28.95,Time:  6.02s
Round  12,Testing accuracy: 25.80,Time:  6.00s
Round  13,Testing accuracy: 24.34,Time:  6.04s
Round  14,Testing accuracy: 32.43,Time:  6.37s
Round  15,Testing accuracy: 28.75,Time:  6.20s
Round  16,Testing accuracy: 21.54,Time:  6.19s
Round  17,Testing accuracy: 19.32,Time:  6.12s
Round  18,Testing accuracy: 21.14,Time:  6.13s
Round  19,Testing accuracy: 26.64,Time:  6.12s
Round  20,Testing accuracy: 25.06,Time:  6.13s
Round  21,Testing accuracy: 23.72,Time:  6.19s
Round  22,Testing accuracy: 25.42,Time:  6.12s
Round  23,Testing accuracy: 22.80,Time:  6.12s
Round  24,Testing accuracy: 24.45,Time:  6.18s
Round  25,Testing accuracy: 19.70,Time:  6.16s
Round  26,Testing accuracy: 23.63,Time:  6.12s
Round  27,Testing accuracy: 21.30,Time:  6.12s
Round  28,Testing accuracy: 27.61,Time:  6.19s
Round  29,Testing accuracy: 25.58,Time:  6.11s
Round  30,Testing accuracy: 24.53,Time:  6.12s
Round  31,Testing accuracy: 23.01,Time:  6.14s
Round  32,Testing accuracy: 21.67,Time:  6.18s
Round  33,Testing accuracy: 22.99,Time:  6.12s
Round  34,Testing accuracy: 18.99,Time:  6.13s
Round  35,Testing accuracy: 20.66,Time:  6.13s
Round  36,Testing accuracy: 24.30,Time:  6.13s
Round  37,Testing accuracy: 28.47,Time:  6.20s
Round  38,Testing accuracy: 25.21,Time:  6.11s
Round  39,Testing accuracy: 23.56,Time:  6.13s
Round  40,Testing accuracy: 25.91,Time:  6.14s
Round  41,Testing accuracy: 21.96,Time:  6.21s
Round  42,Testing accuracy: 19.42,Time:  6.11s
Round  43,Testing accuracy: 19.80,Time:  6.12s
Round  44,Testing accuracy: 20.31,Time:  6.13s
Round  45,Testing accuracy: 20.73,Time:  6.13s
Round  46,Testing accuracy: 22.18,Time:  6.19s
Round  47,Testing accuracy: 23.40,Time:  6.12s
Round  48,Testing accuracy: 21.12,Time:  6.12s
Round  49,Testing accuracy: 25.13,Time:  6.20s
Round  50,Testing accuracy: 21.01,Time:  6.12s
Round  51,Testing accuracy: 23.21,Time:  6.14s
Round  52,Testing accuracy: 20.52,Time:  6.13s
Round  53,Testing accuracy: 17.80,Time:  6.19s
Round  54,Testing accuracy: 18.89,Time:  6.12s
Round  55,Testing accuracy: 21.03,Time:  6.13s
Round  56,Testing accuracy: 21.12,Time:  6.12s
Round  57,Testing accuracy: 19.18,Time:  6.18s
Round  58,Testing accuracy: 18.70,Time:  6.14s
Round  59,Testing accuracy: 17.92,Time:  6.13s
Round  60,Testing accuracy: 21.32,Time:  6.13s
Round  61,Testing accuracy: 23.53,Time:  6.20s
Round  62,Testing accuracy: 23.08,Time:  6.11s
Round  63,Testing accuracy: 18.71,Time:  6.13s
Round  64,Testing accuracy: 17.84,Time:  6.14s
Round  65,Testing accuracy: 16.73,Time:  6.13s
Round  66,Testing accuracy: 17.43,Time:  6.19s
Round  67,Testing accuracy: 17.03,Time:  6.13s
Round  68,Testing accuracy: 17.34,Time:  6.13s
Round  69,Testing accuracy: 16.61,Time:  6.20s
Round  70,Testing accuracy: 16.16,Time:  6.12s
Round  71,Testing accuracy: 16.14,Time:  6.13s
Round  72,Testing accuracy: 18.40,Time:  6.12s
Round  73,Testing accuracy: 17.27,Time:  6.17s
Round  74,Testing accuracy: 18.26,Time:  6.12s
Round  75,Testing accuracy: 17.58,Time:  6.13s
Round  76,Testing accuracy: 18.24,Time:  6.19s
Round  77,Testing accuracy: 18.70,Time:  6.13s
Round  78,Testing accuracy: 15.77,Time:  6.13s
Round  79,Testing accuracy: 15.92,Time:  6.12s
Round  80,Testing accuracy: 14.38,Time:  6.18s
Round  81,Testing accuracy: 12.12,Time:  6.13s
Round  82,Testing accuracy: 13.32,Time:  6.12s
Round  83,Testing accuracy: 14.71,Time:  6.23s
Round  84,Testing accuracy: 16.81,Time:  6.12s
Round  85,Testing accuracy: 17.53,Time:  6.12s
Round  86,Testing accuracy: 19.01,Time:  6.13s
Round  87,Testing accuracy: 17.48,Time:  6.18s
Round  88,Testing accuracy: 19.87,Time:  6.12s
Round  89,Testing accuracy: 19.01,Time:  6.12s
Round  90,Testing accuracy: 18.45,Time:  6.19s
Round  91,Testing accuracy: 20.08,Time:  6.12s
Round  92,Testing accuracy: 19.26,Time:  6.12s
Round  93,Testing accuracy: 19.43,Time:  6.13s
Round  94,Testing accuracy: 17.91,Time:  6.17s
Round  95,Testing accuracy: 13.50,Time:  6.10s
Round  96,Testing accuracy: 14.02,Time:  6.10s
Round  97,Testing accuracy: 15.02,Time:  6.17s
Round  98,Testing accuracy: 15.16,Time:  6.10s
Round  99,Testing accuracy: 16.91,Time:  6.11s
